2025-05-20 23:16:30,362 - __main__ - INFO - 监控服务已启动在端口 5551
2025-05-20 23:16:30,363 - __main__ - INFO - 文件监控已启动，监控文件夹: ./excel
2025-05-20 23:16:30,374 - __main__ - INFO - 数据库连接池初始化成功
2025-05-20 23:16:30,374 - __main__ - INFO - 服务已启动
2025-05-20 23:16:30,375 - __main__ - INFO - 发现新的或已修改的排班文件: 2025-05-20.xlsx
2025-05-20 23:16:30,375 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:16:30,375 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:16:30,441 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:16:30,452 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:16:30,459 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:16:30,465 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:16:30,483 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:16:30,483 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:16:30,484 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:16:30,484 - __main__ - ERROR - 批量更新用户时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:16:30,484 - __main__ - ERROR - 处理部门 综合办 时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:16:30,484 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:16:30,484 - __main__ - INFO - 跳过插入update_only标记的用户: tech1, tech2, tech4, tech5, tech7, tech8, tech10
2025-05-20 23:16:30,484 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 3 条记录
2025-05-20 23:16:30,484 - __main__ - ERROR - 处理部门时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:16:30,484 - __main__ - INFO - 时间点 a 的更新完成，共更新 6 条记录，耗时 0.11 秒
2025-05-20 23:16:32,384 - __main__ - INFO - HTTP服务器已启动在端口 5552
2025-05-20 23:17:34,811 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:17:34,813 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:18:05,795 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:18:05,796 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:18:05,797 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:18:05,798 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:18:05,799 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:18:05,815 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:18:05,828 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:18:05,838 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:18:05,846 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:18:05,855 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:18:05,855 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:18:05,856 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:18:05,856 - __main__ - ERROR - 批量更新用户时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:18:05,856 - __main__ - ERROR - 处理部门 综合办 时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:18:05,856 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:18:05,856 - __main__ - INFO - 跳过插入update_only标记的用户: tech1, tech2, tech4, tech5, tech7, tech8, tech10
2025-05-20 23:18:05,856 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 3 条记录
2025-05-20 23:18:05,856 - __main__ - ERROR - 处理部门时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:18:05,857 - __main__ - INFO - 时间点 a 的更新完成，共更新 6 条记录，耗时 0.06 秒
2025-05-20 23:19:24,584 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:19:24,585 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:19:24,586 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:19:24,587 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:19:24,588 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:19:24,608 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:19:24,621 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:19:24,630 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:19:24,638 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:19:24,647 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:19:24,647 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:19:24,648 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:19:24,648 - __main__ - ERROR - 批量更新用户时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:19:24,648 - __main__ - ERROR - 处理部门 综合办 时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:19:24,648 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:19:24,649 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-20 23:19:24,649 - __main__ - ERROR - 处理部门时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:19:24,649 - __main__ - INFO - 时间点 a 的更新完成，共更新 13 条记录，耗时 0.06 秒
2025-05-20 23:20:58,536 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:20:58,536 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:20:58,537 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:20:58,538 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:20:58,539 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:20:58,558 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:20:58,571 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:20:58,580 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:20:58,588 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:20:58,597 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:20:58,597 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:20:58,598 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:20:58,598 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-20 23:20:58,598 - __main__ - ERROR - 批量更新用户时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:20:58,598 - __main__ - ERROR - 处理部门 综合办 时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:20:58,598 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:20:58,598 - __main__ - ERROR - 处理部门时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:20:58,598 - __main__ - INFO - 时间点 a 的更新完成，共更新 13 条记录，耗时 0.06 秒
2025-05-20 23:21:19,616 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:21:19,616 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:21:19,617 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:21:19,618 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:21:19,620 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:21:19,636 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:21:19,661 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:21:19,673 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:21:19,682 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:21:19,692 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:21:19,692 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:21:19,692 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:21:19,692 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-20 23:21:19,692 - __main__ - ERROR - 批量更新用户时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:21:19,692 - __main__ - ERROR - 处理部门 综合办 时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:21:19,692 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:21:19,692 - __main__ - ERROR - 处理部门时出错: UNIQUE constraint failed: kbk_ic_manager.card
2025-05-20 23:21:19,693 - __main__ - INFO - 时间点 a 的更新完成，共更新 13 条记录，耗时 0.07 秒
2025-05-20 23:21:51,359 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:21:51,359 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:21:51,360 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:21:51,361 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:21:51,361 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:21:51,378 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:21:51,390 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:21:51,400 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:21:51,408 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:21:51,418 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:21:51,418 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:21:51,418 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:21:51,419 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-20 23:21:51,419 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:21:51,419 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-20 23:21:51,420 - __main__ - INFO - 部门 综合办 在时间点 a 更新了 15 条记录
2025-05-20 23:21:51,420 - __main__ - INFO - 时间点 a 的更新完成，共更新 28 条记录，耗时 0.06 秒
2025-05-20 23:24:06,033 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-20 23:24:06,034 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-20 23:24:06,035 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-20 23:24:06,036 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-20 23:24:06,036 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-20 23:24:06,054 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-20 23:24:06,067 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-20 23:24:06,076 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-20 23:24:06,084 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-20 23:24:06,094 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-20 23:24:06,094 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-20 23:24:06,095 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-20 23:24:06,095 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-20 23:24:06,095 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-20 23:24:06,096 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-20 23:24:06,096 - __main__ - INFO - 部门 综合办 在时间点 a 更新了 15 条记录
2025-05-20 23:24:06,096 - __main__ - INFO - 时间点 a 的更新完成，共更新 28 条记录，耗时 0.06 秒
2025-05-21 03:25:00,631 - __main__ - INFO - 触发时间点 a 的更新任务
2025-05-21 03:25:00,679 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-21 03:25:00,679 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-21 03:25:00,680 - __main__ - INFO - 部门 采矿 在时间点 a 更新了 1 条记录
2025-05-21 03:25:00,680 - __main__ - INFO - 部门 选矿 在时间点 a 更新了 10 条记录
2025-05-21 03:25:00,680 - __main__ - INFO - 部门 洗矿 在时间点 a 更新了 2 条记录
2025-05-21 03:25:00,681 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-21 03:25:00,681 - __main__ - INFO - 部门 综合办 在时间点 a 更新了 15 条记录
2025-05-21 03:25:00,681 - __main__ - INFO - 时间点 a 的更新完成，共更新 28 条记录，耗时 0.04 秒
2025-05-21 09:31:10,997 - __main__ - INFO - 触发时间点 b 的更新任务
2025-05-21 09:31:11,060 - __main__ - INFO - 部门 选矿 在时间点 b 更新了 2 条记录
2025-05-21 09:31:11,061 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-21 09:31:11,061 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-21 09:31:11,062 - __main__ - INFO - 部门 采矿 在时间点 b 更新了 0 条记录
2025-05-21 09:31:11,062 - __main__ - INFO - 部门 洗矿 在时间点 b 更新了 0 条记录
2025-05-21 09:31:11,062 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-21 09:31:11,063 - __main__ - INFO - 部门 综合办 在时间点 b 更新了 11 条记录
2025-05-21 09:31:11,063 - __main__ - INFO - 时间点 b 的更新完成，共更新 13 条记录，耗时 0.05 秒
2025-05-21 14:15:38,429 - __main__ - INFO - 检测到文件修改: /Users/bruceplxl/Dev/ICmanager/excel/2025-05-20.xlsx
2025-05-21 14:15:38,431 - __main__ - INFO - 当前使用的文件已修改，重新加载文件: 2025-05-20.xlsx
2025-05-21 14:15:38,435 - __main__ - INFO - 文件内容已变更，更新缓存: 2025-05-20.xlsx
2025-05-21 14:15:38,439 - __main__ - INFO - Excel文件已更新，立即触发一次数据库更新
2025-05-21 14:15:38,440 - __main__ - INFO - 触发时间点 c 的更新任务
2025-05-21 14:15:38,457 - __main__ - INFO - 读取并缓存sheet: 选矿
2025-05-21 14:15:38,476 - __main__ - INFO - 读取并缓存sheet: 洗矿
2025-05-21 14:15:38,484 - __main__ - INFO - 读取并缓存sheet: 采矿
2025-05-21 14:15:38,492 - __main__ - INFO - 读取并缓存sheet: 综合办
2025-05-21 14:15:38,499 - __main__ - INFO - 读取并缓存sheet: breakfast
2025-05-21 14:15:38,506 - __main__ - INFO - 读取并缓存sheet: dinner
2025-05-21 14:15:38,518 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-21 14:15:38,518 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-21 14:15:38,519 - __main__ - INFO - 部门 采矿 在时间点 c 更新了 1 条记录
2025-05-21 14:15:38,519 - __main__ - INFO - 部门 选矿 在时间点 c 更新了 10 条记录
2025-05-21 14:15:38,519 - __main__ - INFO - 部门 洗矿 在时间点 c 更新了 2 条记录
2025-05-21 14:15:38,520 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-21 14:15:38,521 - __main__ - INFO - 部门 综合办 在时间点 c 更新了 15 条记录
2025-05-21 14:15:38,521 - __main__ - INFO - 时间点 c 的更新完成，共更新 28 条记录，耗时 0.08 秒
2025-05-21 14:55:00,072 - __main__ - INFO - 触发时间点 c 的更新任务
2025-05-21 14:55:00,120 - __main__ - INFO - 跳过插入update_only标记的用户: sec1, sec2, sec4, sec5
2025-05-21 14:55:00,120 - __main__ - INFO - 跳过插入update_only标记的用户: ops1, ops2, ops4, ops5, ops7
2025-05-21 14:55:00,121 - __main__ - INFO - 部门 采矿 在时间点 c 更新了 1 条记录
2025-05-21 14:55:00,122 - __main__ - INFO - 部门 选矿 在时间点 c 更新了 10 条记录
2025-05-21 14:55:00,122 - __main__ - INFO - 部门 洗矿 在时间点 c 更新了 2 条记录
2025-05-21 14:55:00,123 - __main__ - INFO - 跳过插入update_only标记的用户: 测试12
2025-05-21 14:55:00,123 - __main__ - INFO - 部门 综合办 在时间点 c 更新了 15 条记录
2025-05-21 14:55:00,123 - __main__ - INFO - 时间点 c 的更新完成，共更新 28 条记录，耗时 0.05 秒
